!function(){var t={881:function(){},84:function(t,e,r){var n=r(881);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals),(0,r(673).Z)("81d37080",n,!0,{})},673:function(t,e,r){"use strict";function n(t,e){for(var r=[],n={},s=0;s<e.length;s++){var i=e[s],o=i[0],a={id:t+":"+s,css:i[1],media:i[2],sourceMap:i[3]};n[o]?n[o].parts.push(a):r.push(n[o]={id:o,parts:[a]})}return r}r.d(e,{Z:function(){return p}});var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=s&&(document.head||document.getElementsByTagName("head")[0]),a=null,u=0,l=!1,h=function(){},d=null,c="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(t,e,r,s){l=r,d=s||{};var o=n(t,e);return m(o),function(e){for(var r=[],s=0;s<o.length;s++){var a=o[s];(u=i[a.id]).refs--,r.push(u)}for(e?m(o=n(t,e)):o=[],s=0;s<r.length;s++){var u;if(0===(u=r[s]).refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete i[u.id]}}}}function m(t){for(var e=0;e<t.length;e++){var r=t[e],n=i[r.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](r.parts[s]);for(;s<r.parts.length;s++)n.parts.push(v(r.parts[s]));n.parts.length>r.parts.length&&(n.parts.length=r.parts.length)}else{var o=[];for(s=0;s<r.parts.length;s++)o.push(v(r.parts[s]));i[r.id]={id:r.id,refs:1,parts:o}}}}function g(){var t=document.createElement("style");return t.type="text/css",o.appendChild(t),t}function v(t){var e,r,n=document.querySelector("style["+c+'~="'+t.id+'"]');if(n){if(l)return h;n.parentNode.removeChild(n)}if(f){var s=u++;n=a||(a=g()),e=$.bind(null,n,s,!1),r=$.bind(null,n,s,!0)}else n=g(),e=y.bind(null,n),r=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else r()}}var w,b=(w=[],function(t,e){return w[t]=e,w.filter(Boolean).join("\n")});function $(t,e,r,n){var s=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,s);else{var i=document.createTextNode(s),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(i,o[e]):t.appendChild(i)}}function y(t,e){var r=e.css,n=e.media,s=e.sourceMap;if(n&&t.setAttribute("media",n),d.ssrId&&t.setAttribute(c,e.id),s&&(r+="\n/*# sourceURL="+s.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var i=e[n]={id:n,exports:{}};return t[n](i,i.exports,r),i.exports}r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";r(84);class t extends Error{constructor(t,e="WebAuthnError"){super(t),this.name=e}}var e,n,s;new class{createNewAbortSignal(){this.controller&&this.controller.abort("Cancelling existing WebAuthn API call for new one");const t=new AbortController;return this.controller=t,t.signal}},e=jQuery,n=Garnish.Base.extend({$loginDiv:null,$form:null,$loginNameInput:null,$passwordInput:null,$rememberMeCheckbox:null,$forgotPasswordLink:null,$rememberPasswordLink:null,$alternativeLoginLink:null,$submitBtn:null,$errors:null,forgotPassword:!1,loginWithPassword:!0,loginWithSecurityKey:!1,validateOnInput:!1,auth2faFlow:!1,auth2fa:null,init:function(){var t=this;this.$loginDiv=e("#login"),this.$form=e("#login-form"),this.$loginNameInput=e("#loginName"),this.$passwordInput=e("#password"),this.$rememberMeCheckbox=e("#rememberMe"),this.$forgotPasswordLink=e("#forgot-password"),this.$rememberPasswordLink=e("#remember-password"),this.$submitBtn=e("#submit"),this.$errors=e("#login-errors"),this.$submitBtn=new Garnish.MultiFunctionBtn(this.$submitBtn,{changeButtonText:!0}),new Craft.PasswordInput(this.$passwordInput,{onToggleInput:function(e){t.removeListener(t.$passwordInput,"input"),t.$passwordInput=e,t.addListener(t.$passwordInput,"input","onInput")}}),this.addListener(this.$loginNameInput,"input","onInput"),this.addListener(this.$passwordInput,"input","onInput"),this.addListener(this.$forgotPasswordLink,"click","onSwitchForm"),this.addListener(this.$rememberPasswordLink,"click","onSwitchForm"),this.addListener(this.$form,"submit","onSubmit"),Garnish.isMobileBrowser()||(this.$loginNameInput.val()?this.$passwordInput.focus():this.$loginNameInput.focus())},validate:function(){var t=this.$loginNameInput.val();if(0===t.length)return window.useEmailAsUsername?Craft.t("app","Invalid email."):Craft.t("app","Invalid username or email.");if(window.useEmailAsUsername&&!t.match(".+@.+..+"))return Craft.t("app","Invalid email.");if(!this.forgotPassword&&this.loginWithPassword){var e=this.$passwordInput.val().length;if(e<window.minPasswordLength)return Craft.t("yii","{attribute} should contain at least {min, number} {min, plural, one{character} other{characters}}.",{attribute:Craft.t("app","Password"),min:window.minPasswordLength});if(e>window.maxPasswordLength)return Craft.t("yii","{attribute} should contain at most {max, number} {max, plural, one{character} other{characters}}.",{attribute:Craft.t("app","Password"),max:window.maxPasswordLength})}return!0},onInput:function(t){this.validateOnInput&&!0===this.validate()&&this.clearErrors()},onSubmit:function(t){t.preventDefault();var r=this.validate();if(!0!==r)return this.showError(r),void(this.validateOnInput=!0);this.$submitBtn.busyEvent(),this.clearErrors(),e(t.originalEvent.submitter).hasClass("auth2fa-webauthn")?(this.loginWithSecurityKey=!0,this.loginWithPassword=!1):(this.loginWithSecurityKey=!1,this.loginWithPassword=!0),this.forgotPassword?this.submitForgotPassword():this.loginWithSecurityKey?this.webauthnLogin():this.auth2faFlow?this.submit2faCode():this.loginWithPassword?this.submitLogin():this.submitFindUser()},submitForgotPassword:function(){var t=this,e={loginName:this.$loginNameInput.val()};Craft.sendActionRequest("POST","users/send-password-reset-email",{data:e}).then((function(t){new s})).catch((function(e){var r=e.response;t.showError(r.data.message)}))},webauthnLogin:function(){var t=this;this.clearErrors();var r=e("#auth-2fa-form").find("button");(r=new Garnish.MultiFunctionBtn(r)).busyEvent();var n={loginName:this.$loginNameInput.val(),rememberMe:this.$rememberMeCheckbox.prop("checked")?"y":""};new Craft.Auth2faLogin.startWebauthnLogin(n,!1).then((function(t){r.successEvent(),null!=t.returnUrl&&(window.location.href=t.returnUrl)})).catch((function(e){r.failureEvent(),t.processFailure(e.error)}))},submit2faCode:function(){var t=this;this.clearErrors();var r=e("#auth-2fa-form").find("button");(r=new Garnish.MultiFunctionBtn(r)).busyEvent(),new Craft.Auth2faLogin.submit2faCode(e("#auth-2fa-form"),!1).then((function(t){r.successEvent(),window.location.href=t.returnUrl})).catch((function(e){r.failureEvent(),t.processFailure(e.error)}))},submitLogin:function(){var t=this;this.clearErrors(),this.$submitBtn.busyEvent(),this.auth2fa=new Craft.Auth2fa;var e={loginName:this.$loginNameInput.val(),password:this.$passwordInput.val(),rememberMe:this.$rememberMeCheckbox.prop("checked")?"y":""};return Craft.sendActionRequest("POST","users/login",{data:e}).then((function(e){void 0!==e.data.auth2fa&&1==e.data.auth2fa?(t.auth2faFlow=!0,null!==t.$alternativeLoginLink&&t.$alternativeLoginLink.remove(),t.auth2fa.show2faForm(e.data.auth2faForm,t.$loginDiv),t.$submitBtn.endBusyState()):(t.$submitBtn.successEvent(),window.location.href=e.data.returnUrl)})).catch((function(e){var r=e.response;t.$submitBtn.failureEvent(),t.processFailure(r.data.message)})),!1},processFailure:function(t){Garnish.shake(this.$form,"left"),this.onSubmitResponse(),this.showError(t),this.$submitBtn.failureEvent()},onSubmitResponse:function(){this.$submitBtn.failureEvent()},showError:function(t){this.clearErrors(),e('<p style="display: none;">'+t+"</p>").appendTo(this.$errors).velocity("fadeIn")},clearErrors:function(){this.$errors.empty()},onSwitchForm:function(t){Garnish.isMobileBrowser()||this.$loginNameInput.trigger("focus"),this.clearErrors(),this.forgotPassword=!this.forgotPassword,this.$form.toggleClass("reset-password",this.forgotPassword),this.$submitBtn.updateMessages(Craft.t("app",this.forgotPassword?"Reset Password":"Sign in"))}}),s=Garnish.Modal.extend({init:function(){var t=e('<div class="modal fitted email-sent"><div class="body">'+Craft.t("app","Check your email for instructions to reset your password.")+"</div></div>").appendTo(Garnish.$bod);this.base(t)},hide:function(){}}),new n}()}();
//# sourceMappingURL=login.js.map