{"version":3,"file":"AccountSettingsForm.js","mappings":"YAAA,IAAWA,IAoHRC,OAjHDC,MAAMC,oBAAsBC,QAAQC,KAAKC,OACvC,CACEC,OAAQ,KACRC,UAAW,KAEXC,yBAA0B,KAC1BC,yBAA0B,KAC1BC,WAAY,KAEZC,mBAAoB,KACpBC,WAAY,KAEZC,KAAM,SAAUP,EAAQC,EAAWO,GACjCC,KAAKT,OAASA,EACdS,KAAKR,UAAYA,EAEjBQ,KAAKC,YAAYF,EAAUb,MAAMC,oBAAoBe,UAErDF,KAAKP,yBAA2BT,EAAE,2BAClCgB,KAAKN,yBAA2BV,EAAE,2BAClCgB,KAAKL,WAAaX,EAAE,mBACpBgB,KAAKH,WAAab,EAAE,eAEpBgB,KAAKG,YACHH,KAAKP,yBACL,QACA,sCAEFO,KAAKG,YACHH,KAAKN,yBACL,QACA,sCAEFM,KAAKG,YAAYH,KAAKH,WAAY,QAAS,yBAC7C,EAEAO,mCAAoC,WAElClB,MAAMmB,uBAAuBC,uBAC3BN,KAAKO,oBAAoBC,KAAKR,MAElC,EAEAO,oBAAqB,WAAY,WAC/BP,KAAKL,WAAWc,SAAS,WAEzB,IAAIC,EAAO,CACTnB,OAAQS,KAAKT,QAGfL,MAAMyB,kBAAkB,OAAQ,+BAAgC,CAACD,KAAAA,IAC9DE,MAAK,SAACC,GACL,EAAKlB,WAAWmB,YAAY,WAC5B5B,MAAM6B,GAAGC,qBAAqB,CAC5BC,MAAO/B,MAAMgC,EAAE,MAAO,2BACtBC,MAAON,EAASH,KAAKU,KAEzB,IAAE,OACK,YAAU,EAARP,SACP,EAAKlB,WAAWmB,YAAY,UAC9B,GACJ,EAEAO,mCAAoC,WAAY,WAC9CrB,KAAKL,WAAWc,SAAS,WAEzB,IAAIC,EAAO,CACTnB,OAAQS,KAAKT,QAGfL,MAAMyB,kBAAkB,OAAQ,8BAA+B,CAACD,KAAAA,IAC7DE,MAAK,SAACC,GACL,EAAKlB,WAAWmB,YAAY,WAC5B5B,MAAM6B,GAAGC,qBAAqB,CAC5BC,MAAO/B,MAAMgC,EACX,MACA,oEAEFC,MAAON,EAASH,KAAKU,KAEzB,IAAE,OACK,YAAU,EAARP,SACP,EAAKlB,WAAWmB,YAAY,UAC9B,GACJ,EAEAQ,uBAAwB,WAAY,WAClC,GAAKtB,KAAKJ,mBAgBRI,KAAKJ,mBAAmB2B,WAhBI,CAC5BvB,KAAKL,WAAWc,SAAS,WAEzB,IAAIC,EAAO,CAACnB,OAAQS,KAAKT,QACzBL,MAAMyB,kBAAkB,OAAQ,6BAA8B,CAACD,KAAAA,IAC5DE,MAAK,SAACC,GACL,EAAKlB,WAAWmB,YAAY,WAC5B,EAAKlB,mBAAqB,IAAIV,MAAMsC,gBAAgB,EAAKjC,OAAQ,CAC/DkC,eAAgBZ,EAASH,KACzBgB,SAAU,EAAK3B,SAAS4B,qBAE5B,IAAE,OACK,YAAU,EAARd,SACP,EAAKlB,WAAWmB,YAAY,UAC9B,GACJ,CAGF,GAEF,CACEZ,SAAU,CACRyB,oBAAqB,O","sources":["webpack:///./AccountSettingsForm.js"],"sourcesContent":["(function ($) {\n  /** global: Craft */\n  /** global: Garnish */\n  Craft.AccountSettingsForm = Garnish.Base.extend(\n    {\n      userId: null,\n      isCurrent: null,\n\n      $copyPasswordResetUrlBtn: null,\n      $copyImpersonationUrlBtn: null,\n      $actionBtn: null,\n\n      confirmDeleteModal: null,\n      $deleteBtn: null,\n\n      init: function (userId, isCurrent, settings) {\n        this.userId = userId;\n        this.isCurrent = isCurrent;\n\n        this.setSettings(settings, Craft.AccountSettingsForm.defaults);\n\n        this.$copyPasswordResetUrlBtn = $('#copy-passwordreset-url');\n        this.$copyImpersonationUrlBtn = $('#copy-impersonation-url');\n        this.$actionBtn = $('#action-menubtn');\n        this.$deleteBtn = $('#delete-btn');\n\n        this.addListener(\n          this.$copyPasswordResetUrlBtn,\n          'click',\n          'handleCopyPasswordResetUrlBtnClick'\n        );\n        this.addListener(\n          this.$copyImpersonationUrlBtn,\n          'click',\n          'handleCopyImpersonationUrlBtnClick'\n        );\n        this.addListener(this.$deleteBtn, 'click', 'showConfirmDeleteModal');\n      },\n\n      handleCopyPasswordResetUrlBtnClick: function () {\n        // Requires an elevated session\n        Craft.elevatedSessionManager.requireElevatedSession(\n          this.getPasswordResetUrl.bind(this)\n        );\n      },\n\n      getPasswordResetUrl: function () {\n        this.$actionBtn.addClass('loading');\n\n        var data = {\n          userId: this.userId,\n        };\n\n        Craft.sendActionRequest('POST', 'users/get-password-reset-url', {data})\n          .then((response) => {\n            this.$actionBtn.removeClass('loading');\n            Craft.ui.createCopyTextPrompt({\n              label: Craft.t('app', 'Copy the activation URL'),\n              value: response.data.url,\n            });\n          })\n          .catch(({response}) => {\n            this.$actionBtn.removeClass('loading');\n          });\n      },\n\n      handleCopyImpersonationUrlBtnClick: function () {\n        this.$actionBtn.addClass('loading');\n\n        var data = {\n          userId: this.userId,\n        };\n\n        Craft.sendActionRequest('POST', 'users/get-impersonation-url', {data})\n          .then((response) => {\n            this.$actionBtn.removeClass('loading');\n            Craft.ui.createCopyTextPrompt({\n              label: Craft.t(\n                'app',\n                'Copy the impersonation URL, and open it in a new private window.'\n              ),\n              value: response.data.url,\n            });\n          })\n          .catch(({response}) => {\n            this.$actionBtn.removeClass('loading');\n          });\n      },\n\n      showConfirmDeleteModal: function () {\n        if (!this.confirmDeleteModal) {\n          this.$actionBtn.addClass('loading');\n\n          let data = {userId: this.userId};\n          Craft.sendActionRequest('POST', 'users/user-content-summary', {data})\n            .then((response) => {\n              this.$actionBtn.removeClass('loading');\n              this.confirmDeleteModal = new Craft.DeleteUserModal(this.userId, {\n                contentSummary: response.data,\n                redirect: this.settings.deleteModalRedirect,\n              });\n            })\n            .catch(({response}) => {\n              this.$actionBtn.removeClass('loading');\n            });\n        } else {\n          this.confirmDeleteModal.show();\n        }\n      },\n    },\n    {\n      defaults: {\n        deleteModalRedirect: null,\n      },\n    }\n  );\n})(jQuery);\n"],"names":["$","jQuery","Craft","AccountSettingsForm","Garnish","Base","extend","userId","isCurrent","$copyPasswordResetUrlBtn","$copyImpersonationUrlBtn","$actionBtn","confirmDeleteModal","$deleteBtn","init","settings","this","setSettings","defaults","addListener","handleCopyPasswordResetUrlBtnClick","elevatedSessionManager","requireElevatedSession","getPasswordResetUrl","bind","addClass","data","sendActionRequest","then","response","removeClass","ui","createCopyTextPrompt","label","t","value","url","handleCopyImpersonationUrlBtnClick","showConfirmDeleteModal","show","DeleteUserModal","contentSummary","redirect","deleteModalRedirect"],"sourceRoot":""}